<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="UTF-8">
<title>Foot Care Training</title>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<style>
body{font-family:Arial;background:#f4f6f8;margin:0;padding:20px;}
h2{text-align:center;}
.container{max-width:1100px;margin:auto;}

.cards{display:flex;gap:20px;justify-content:center;margin-bottom:20px;}
.card{
    background:white;
    border-radius:12px;
    padding:20px;
    width:180px;
    text-align:center;
    box-shadow:0 4px 10px rgba(0,0,0,0.1);
}
.big{font-size:28px;font-weight:bold;margin:10px 0;}

button{
    background:#007bff;color:white;border:none;
    padding:10px 15px;border-radius:8px;cursor:pointer;
}
button:hover{background:#0056b3;}

.timer{text-align:center;font-size:28px;margin:20px 0;}

.xyz-box{
    display:flex;
    gap:15px;
    justify-content:center;
    margin-top:10px;
}

.xyz{
    background:white;
    padding:15px;
    border-radius:10px;
    box-shadow:0 4px 10px rgba(0,0,0,0.1);
    width:100px;
    text-align:center;
}

table{
    width:100%;
    border-collapse:collapse;
    background:white;
    margin-top:20px;
}
th,td{
    border:1px solid #ccc;
    padding:10px;
    text-align:center;
}
th{background:#007bff;color:white;}

canvas{
    background:white;
    margin-top:30px;
    padding:10px;
    border-radius:12px;
}
</style>
</head>

<body>
<div class="container">
<h2>Foot Care Training</h2>

<div class="cards">
    <div class="card">
        <div>Dorsi</div>
        <div class="big" id="dorsiVal">0</div>
    </div>

    <div class="card">
        <div>Plantar</div>
        <div class="big" id="plantarVal">0</div>
    </div>
</div>

<!-- X Y Z -->
<div class="xyz-box">
    <div class="xyz">X<br><span id="xVal">0</span></div>
    <div class="xyz">Y<br><span id="yVal">0</span></div>
    <div class="xyz">Z<br><span id="zVal">0</span></div>
</div>

<div class="timer">
‚è±Ô∏è ‡πÄ‡∏ß‡∏•‡∏≤: <span id="timer">30</span> ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ
<br><br>
<button onclick="startTraining()">‡πÄ‡∏£‡∏¥‡πà‡∏°</button>
</div>

<table>
<thead>
<tr>
<th>‡πÄ‡∏ã‡∏ó</th>
<th>Dorsi Max</th>
<th>Plantar Max</th>
<th>ROM</th>
</tr>
</thead>
<tbody id="resultTable">
<tr><td>1</td><td>-</td><td>-</td><td>-</td></tr>
<tr><td>2</td><td>-</td><td>-</td><td>-</td></tr>
<tr><td>3</td><td>-</td><td>-</td><td>-</td></tr>
<tr><td>4</td><td>-</td><td>-</td><td>-</td></tr>
<tr><td>5</td><td>-</td><td>-</td><td>-</td></tr>
</tbody>
</table>

<canvas id="liveChart" height="120"></canvas>
<canvas id="summaryChart" height="120"></canvas>

</div>

<script>
let timerEl=document.getElementById("timer");
let dorsiVal=document.getElementById("dorsiVal");
let plantarVal=document.getElementById("plantarVal");
let xVal=document.getElementById("xVal");
let yVal=document.getElementById("yVal");
let zVal=document.getElementById("zVal");
let table=document.getElementById("resultTable");

let timeLeft=30;
let interval;
let currentSet=0;

let maxDorsi=0;
let maxPlantar=0;

const liveChart=new Chart(document.getElementById("liveChart"),{
    type:"line",
    data:{labels:[],datasets:[
        {label:"Dorsi",data:[],borderWidth:2},
        {label:"Plantar",data:[],borderWidth:2}
    ]}
});

const summaryChart=new Chart(document.getElementById("summaryChart"),{
    type:"bar",
    data:{labels:[],datasets:[
        {label:"Dorsi Max",data:[],borderWidth:1},
        {label:"Plantar Max",data:[],borderWidth:1},
        {label:"ROM",data:[],borderWidth:1}
    ]}
});

function resetXYZ(){
    xVal.innerText=0;
    yVal.innerText=0;
    zVal.innerText=0;
    dorsiVal.innerText=0;
    plantarVal.innerText=0;
}

function startTraining(){
    if(currentSet>=5)return;

    resetXYZ();
    timeLeft=30;
    timerEl.innerText=timeLeft;
    maxDorsi=0;
    maxPlantar=0;

    liveChart.data.labels=[];
    liveChart.data.datasets[0].data=[];
    liveChart.data.datasets[1].data=[];
    liveChart.update();

    interval=setInterval(()=>{
        timeLeft--;
        timerEl.innerText=timeLeft;

        // üî• ‡∏ï‡∏£‡∏á‡∏ô‡∏µ‡πâ‡πÄ‡∏≠‡∏≤‡∏Ñ‡πà‡∏≤ Firebase ‡∏à‡∏£‡∏¥‡∏á‡∏°‡∏≤‡πÅ‡∏ó‡∏ô‡πÑ‡∏î‡πâ
        let x=Math.random()*40-20;
        let y=Math.random()*50-25;
        let z=Math.random()*30-15;

        let dorsi=x;
        let plantar=y;

        xVal.innerText=x.toFixed(1);
        yVal.innerText=y.toFixed(1);
        zVal.innerText=z.toFixed(1);

        dorsiVal.innerText=dorsi.toFixed(1);
        plantarVal.innerText=plantar.toFixed(1);

        if(Math.abs(dorsi)>maxDorsi)maxDorsi=Math.abs(dorsi);
        if(Math.abs(plantar)>maxPlantar)maxPlantar=Math.abs(plantar);

        liveChart.data.labels.push(30-timeLeft);
        liveChart.data.datasets[0].data.push(dorsi);
        liveChart.data.datasets[1].data.push(plantar);
        liveChart.update();

        if(timeLeft<=0){
            clearInterval(interval);
            finishSet();
        }
    },1000);
}

function finishSet(){
    let rom=maxDorsi+maxPlantar;

    table.rows[currentSet].cells[1].innerText=maxDorsi.toFixed(1);
    table.rows[currentSet].cells[2].innerText=maxPlantar.toFixed(1);
    table.rows[currentSet].cells[3].innerText=rom.toFixed(1);

    summaryChart.data.labels.push("‡πÄ‡∏ã‡∏ó "+(currentSet+1));
    summaryChart.data.datasets[0].data.push(maxDorsi);
    summaryChart.data.datasets[1].data.push(maxPlantar);
    summaryChart.data.datasets[2].data.push(rom);
    summaryChart.update();

    currentSet++;
    resetXYZ();
}
</script>

</body>
</html>

