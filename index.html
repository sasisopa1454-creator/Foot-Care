<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="UTF-8">
<title>Foot Care Training</title>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<style>
body{
    font-family: Arial, sans-serif;
    background:#f4f6f8;
    margin:0;
    padding:20px;
}
h2{text-align:center;}

.container{
    max-width:1000px;
    margin:auto;
}

.cards{
    display:flex;
    gap:20px;
    justify-content:center;
    margin-bottom:20px;
}

.card{
    background:white;
    border-radius:12px;
    padding:20px;
    width:220px;
    text-align:center;
    box-shadow:0 4px 10px rgba(0,0,0,0.1);
}

.big{
    font-size:28px;
    font-weight:bold;
    margin:10px 0;
}

button{
    background:#007bff;
    color:white;
    border:none;
    padding:10px 15px;
    border-radius:8px;
    cursor:pointer;
}
button:hover{background:#0056b3;}

.timer{
    text-align:center;
    font-size:24px;
    margin:20px 0;
}

table{
    width:100%;
    border-collapse:collapse;
    background:white;
    margin-top:20px;
}
th,td{
    border:1px solid #ccc;
    padding:10px;
    text-align:center;
}
th{
    background:#007bff;
    color:white;
}

canvas{
    background:white;
    margin-top:30px;
    padding:10px;
    border-radius:12px;
}
</style>
</head>

<body>
<div class="container">
<h2>Foot Care Training</h2>

<!-- ‡∏Å‡∏≤‡∏£‡πå‡∏î -->
<div class="cards">
    <div class="card">
        <div>‡∏¢‡∏Å‡πÄ‡∏ó‡πâ‡∏≤ (Dorsi)</div>
        <div class="big"><span id="dorsiSet">0</span> / 5</div>
        <button onclick="startSet('dorsi')">‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏¢‡∏Å‡πÄ‡∏ó‡πâ‡∏≤</button>
    </div>

    <div class="card">
        <div>‡πÄ‡∏´‡∏¢‡∏µ‡∏¢‡∏î‡πÄ‡∏ó‡πâ‡∏≤ (Plantar)</div>
        <div class="big"><span id="plantarSet">0</span> / 5</div>
        <button onclick="startSet('plantar')">‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÄ‡∏´‡∏¢‡∏µ‡∏¢‡∏î‡πÄ‡∏ó‡πâ‡∏≤</button>
    </div>
</div>

<!-- ‡∏ï‡∏±‡∏ß‡∏à‡∏±‡∏ö‡πÄ‡∏ß‡∏•‡∏≤ -->
<div class="timer">
‚è±Ô∏è ‡πÄ‡∏ß‡∏•‡∏≤: <span id="timer">30</span> ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ
</div>

<!-- ‡∏ï‡∏≤‡∏£‡∏≤‡∏á -->
<table>
<thead>
<tr>
<th>‡πÄ‡∏ã‡∏ó</th>
<th>Dorsi</th>
<th>Plantar</th>
<th>ROM</th>
</tr>
</thead>
<tbody id="resultTable">
<tr><td>1</td><td>-</td><td>-</td><td>-</td></tr>
<tr><td>2</td><td>-</td><td>-</td><td>-</td></tr>
<tr><td>3</td><td>-</td><td>-</td><td>-</td></tr>
<tr><td>4</td><td>-</td><td>-</td><td>-</td></tr>
<tr><td>5</td><td>-</td><td>-</td><td>-</td></tr>
</tbody>
</table>

<!-- ‡∏Å‡∏£‡∏≤‡∏ü‡∏™‡∏£‡∏∏‡∏õ‡πÅ‡∏ï‡πà‡∏•‡∏∞‡πÄ‡∏ã‡∏ó -->
<h3 style="margin-top:40px;">‡∏Å‡∏£‡∏≤‡∏ü‡∏™‡∏£‡∏∏‡∏õ‡∏ú‡∏•‡πÅ‡∏ï‡πà‡∏•‡∏∞‡πÄ‡∏ã‡∏ó</h3>
<canvas id="chart" height="120"></canvas>

<!-- ‡∏Å‡∏£‡∏≤‡∏ü 30 ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ -->
<h3 style="margin-top:40px;">‡∏Å‡∏£‡∏≤‡∏ü‡∏Å‡∏≤‡∏£‡πÄ‡∏Ñ‡∏•‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏´‡∏ß‡∏†‡∏≤‡∏¢‡πÉ‡∏ô 30 ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ</h3>
<canvas id="progressChart" height="120"></canvas>

</div>

<script>

let dorsiSet = 0;
let plantarSet = 0;
let timeLeft = 30;
let timer;

let progressSecond = 0;

const timerEl = document.getElementById("timer");
const dorsiSetEl = document.getElementById("dorsiSet");
const plantarSetEl = document.getElementById("plantarSet");
const tableEl = document.getElementById("resultTable");

/* ----------------- ‡∏Å‡∏£‡∏≤‡∏ü‡∏™‡∏£‡∏∏‡∏õ ----------------- */
const chart = new Chart(document.getElementById("chart"), {
    type: "line",
    data: {
        labels: [],
        datasets: [
            { label: "Dorsi", data: [], borderWidth:2 },
            { label: "Plantar", data: [], borderWidth:2 },
            { label: "ROM", data: [], borderWidth:2 }
        ]
    },
    options:{animation:false}
});

/* ----------------- ‡∏Å‡∏£‡∏≤‡∏ü 30 ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ ----------------- */
const progressChart = new Chart(document.getElementById("progressChart"), {
    type: "line",
    data: {
        labels: [],
        datasets: [
            { label: "ROM ‡∏ï‡πà‡∏≠‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ", data: [], borderWidth:2 }
        ]
    },
    options:{
        animation:false,
        scales:{
            x:{ title:{display:true,text:"‡πÄ‡∏ß‡∏•‡∏≤ (‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ)"} },
            y:{ title:{display:true,text:"‡∏Ñ‡πà‡∏≤ ROM"} }
        }
    }
});

function startSet(mode){

    if(mode==="dorsi" && dorsiSet>=5) return;
    if(mode==="plantar" && plantarSet>=5) return;

    clearInterval(timer);
    timeLeft = 30;
    timerEl.innerText = timeLeft;

    progressSecond = 0;
    progressChart.data.labels = [];
    progressChart.data.datasets[0].data = [];
    progressChart.update();

    timer = setInterval(()=>{

        timeLeft--;
        timerEl.innerText = timeLeft;

        // üîπ ‡∏à‡∏≥‡∏•‡∏≠‡∏á‡∏Ñ‡πà‡∏≤ ROM ‡∏ï‡πà‡∏≠‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ
        let romNow = Math.floor(Math.random()*50);

        progressChart.data.labels.push(progressSecond);
        progressChart.data.datasets[0].data.push(romNow);
        progressChart.update();

        progressSecond++;

        if(timeLeft<=0){
            clearInterval(timer);
            finishSet(mode);
        }

    },1000);
}

function finishSet(mode){

    let dorsi = Math.floor(Math.random()*20)+10;
    let plantar = Math.floor(Math.random()*30)+20;

    let rowIndex;

    if(mode==="dorsi"){
        dorsiSet++;
        dorsiSetEl.innerText = dorsiSet;
        rowIndex = dorsiSet-1;
        tableEl.rows[rowIndex].cells[1].innerText = dorsi;
    }

    if(mode==="plantar"){
        plantarSet++;
        plantarSetEl.innerText = plantarSet;
        rowIndex = plantarSet-1;
        tableEl.rows[rowIndex].cells[2].innerText = plantar;
    }

    let dVal = tableEl.rows[rowIndex].cells[1].innerText;
    let pVal = tableEl.rows[rowIndex].cells[2].innerText;

    if(dVal!=="-" && pVal!=="-"){

        let rom = pVal - dVal;
        tableEl.rows[rowIndex].cells[3].innerText = rom;

        chart.data.labels.push("‡πÄ‡∏ã‡∏ó "+(rowIndex+1));
        chart.data.datasets[0].data.push(dVal);
        chart.data.datasets[1].data.push(pVal);
        chart.data.datasets[2].data.push(rom);
        chart.update();
    }
}

</script>
</body>
</html>



