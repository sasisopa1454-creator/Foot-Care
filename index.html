// ===============================
//  FOOT CARE - Firebase Live View
// ===============================

// ğŸ”¹ Firebase SDK (à¹€à¸§à¸­à¸£à¹Œà¸Šà¸±à¸™à¹€à¸”à¸µà¸¢à¸§!)
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
import { getDatabase, ref, onValue } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-database.js";

// ğŸ”¹ Firebase Config (à¸‚à¸­à¸‡à¹‚à¸›à¸£à¹€à¸ˆà¸à¸•à¹Œà¸„à¸¸à¸“)
const firebaseConfig = {
  apiKey: "AIzaSyArB39e1jNG71QNBrSDGoXzQk7o4HE9SfM",
  databaseURL: "https://foot-care-15028-default-rtdb.asia-southeast1.firebasedatabase.app",
  projectId: "foot-care-15028",
  appId: "1:568507097776:web:5ecd08c79da53ed42f1175"
};

// ğŸ”¹ Init Firebase
console.log("ğŸ”¥ script.js loaded");
const app = initializeApp(firebaseConfig);
const db = getDatabase(app);

// ===============================
// ğŸ”´ à¸”à¸¶à¸‡à¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¸ˆà¸²à¸ ESP32 (/live)
// ===============================
const liveRef = ref(db, "live");

onValue(liveRef, (snapshot) => {
  const data = snapshot.val();
  console.log("ğŸ“¡ Firebase data:", data);

  if (!data) return;

  const angleX = data.angleX ?? 0;
  const angleY = data.angleY ?? 0;

  // ğŸ”¹ à¹à¸ªà¸”à¸‡à¸šà¸™à¸«à¸™à¹‰à¸²à¹€à¸§à¹‡à¸š
  const dorsiEl = document.getElementById("liveDorsi");
  const plantarEl = document.getElementById("livePlantar");

  if (dorsiEl) dorsiEl.innerText = angleX.toFixed(1);
  if (plantarEl) plantarEl.innerText = angleY.toFixed(1);
});
